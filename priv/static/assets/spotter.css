/* ============================================================
   Graphite Design System — Spotter
   ============================================================ */

/* --- Tokens --- */
:root {
  /* Surface layers */
  --surface-0: #0c0e14;
  --surface-1: #13161f;
  --surface-2: #1a1e2a;
  --surface-3: #232836;
  --surface-4: #2d3344;

  /* Text */
  --text-primary: #e8eaf0;
  --text-secondary: #8b90a0;
  --text-tertiary: #555a6e;

  /* Accents */
  --accent-blue: #5b9cf5;
  --accent-green: #4ac89a;
  --accent-amber: #e5a84b;
  --accent-red: #e85454;
  --accent-purple: #a78bfa;
  --accent-cyan: #5bc4c8;

  /* Borders */
  --border-subtle: #1e2230;
  --border-default: #2a2f3e;
  --border-strong: #3a4052;

  /* Typography */
  --font-ui: 'Bricolage Grotesque', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  --font-mono: 'JetBrains Mono', 'Fira Code', monospace;

  /* Scale */
  --text-xs: 12px;
  --text-sm: 13px;
  --text-base: 14px;
  --text-lg: 18px;
  --text-xl: 24px;

  /* Spacing (4px base unit) */
  --space-1: 4px;
  --space-2: 8px;
  --space-3: 12px;
  --space-4: 16px;
  --space-5: 24px;
  --space-6: 32px;
  --space-7: 48px;
  --space-8: 64px;

  /* Radii */
  --radius-sm: 4px;
  --radius-md: 6px;
  --radius-lg: 8px;
}

/* --- Reset --- */
*, *::before, *::after {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

/* --- Base --- */
body {
  font-family: var(--font-ui);
  font-size: var(--text-sm);
  color: var(--text-primary);
  background: var(--surface-0);
  line-height: 1.5;
}

/* Grain texture overlay */
body::before {
  content: '';
  position: fixed;
  inset: 0;
  z-index: 9999;
  pointer-events: none;
  opacity: 0.03;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
  background-repeat: repeat;
}

a {
  color: var(--accent-blue);
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

h1, h2, h3, h4, h5, h6 {
  font-weight: 600;
  line-height: 1.3;
}

h1 { font-size: var(--text-xl); }
h2 { font-size: var(--text-lg); }
h3 { font-size: var(--text-base); }

code, pre {
  font-family: var(--font-mono);
}

/* --- App Shell --- */
.app-shell {
  display: flex;
  min-height: 100vh;
}

.sidebar {
  width: 200px;
  flex-shrink: 0;
  background: var(--surface-1);
  border-right: 1px solid var(--border-subtle);
  position: sticky;
  top: 0;
  height: 100vh;
  overflow-y: auto;
  padding: var(--space-4) var(--space-3);
  display: flex;
  flex-direction: column;
  gap: var(--space-5);
}

.sidebar-brand {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  padding: var(--space-1) var(--space-2);
}

.sidebar-logo {
  width: 28px;
  height: 28px;
  background: var(--accent-blue);
  border-radius: var(--radius-sm);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: var(--text-sm);
  color: var(--surface-0);
}

.sidebar-title {
  font-weight: 600;
  font-size: var(--text-base);
  color: var(--text-primary);
}

.sidebar-nav {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.sidebar-link {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  padding: var(--space-2) var(--space-3);
  border-radius: var(--radius-sm);
  color: var(--text-secondary);
  font-size: var(--text-sm);
  font-weight: 500;
  text-decoration: none;
  transition: background 0.15s, color 0.15s;
}

.sidebar-link:hover {
  background: var(--surface-2);
  color: var(--text-primary);
  text-decoration: none;
}

.sidebar-link.is-active {
  background: var(--surface-3);
  color: var(--accent-blue);
}

.sidebar-badge {
  margin-left: auto;
  background: var(--accent-blue);
  color: var(--surface-0);
  font-size: var(--text-xs);
  font-weight: 600;
  line-height: 1;
  padding: 2px 6px;
  border-radius: 9999px;
}

.main-content {
  flex: 1;
  min-width: 0;
  overflow-x: hidden;
}

/* --- Breadcrumb --- */
.breadcrumb {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  padding: var(--space-3) var(--space-4);
  border-bottom: 1px solid var(--border-subtle);
  font-size: var(--text-xs);
  color: var(--text-secondary);
}

.breadcrumb a {
  color: var(--text-secondary);
  text-decoration: none;
}

.breadcrumb a:hover {
  color: var(--text-primary);
  text-decoration: none;
}

.breadcrumb .breadcrumb-sep {
  color: var(--text-tertiary);
}

.breadcrumb .breadcrumb-current {
  color: var(--text-primary);
  font-weight: 500;
}

.breadcrumb .breadcrumb-meta {
  margin-left: auto;
  color: var(--text-tertiary);
  font-size: var(--text-xs);
}

/* --- Container --- */
.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: var(--space-4);
}

/* --- Panel --- */
.panel {
  background: var(--surface-1);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-lg);
  padding: var(--space-4);
}

/* --- Card --- */
.card {
  background: var(--surface-2);
  border: 1px solid var(--border-subtle);
  border-radius: var(--radius-md);
  padding: var(--space-4);
}

.card:hover {
  border-color: var(--border-default);
}

/* --- Buttons --- */
.btn {
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
  padding: var(--space-2) var(--space-4);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-sm);
  background: var(--surface-2);
  color: var(--text-primary);
  font-family: var(--font-ui);
  font-size: var(--text-sm);
  font-weight: 500;
  cursor: pointer;
  transition: background 0.15s, border-color 0.15s;
}

.btn:hover {
  background: var(--surface-3);
  border-color: var(--border-strong);
}

.btn-primary {
  background: var(--accent-blue);
  border-color: var(--accent-blue);
  color: var(--surface-0);
}

.btn-primary:hover {
  background: #4a8be4;
  border-color: #4a8be4;
}

.btn-success {
  background: var(--accent-green);
  border-color: var(--accent-green);
  color: var(--surface-0);
}

.btn-success:hover {
  background: #3ab78a;
  border-color: #3ab78a;
}

.btn-danger {
  background: var(--accent-red);
  border-color: var(--accent-red);
  color: var(--surface-0);
}

.btn-danger:hover {
  background: #d74343;
  border-color: #d74343;
}

.btn-ghost {
  background: transparent;
  border-color: transparent;
  color: var(--text-secondary);
}

.btn-ghost:hover {
  background: var(--surface-2);
  color: var(--text-primary);
}

/* Also style bare <button> for backwards compat with existing templates */
button {
  padding: var(--space-2) var(--space-4);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-sm);
  background: var(--surface-2);
  color: var(--text-primary);
  font-family: var(--font-ui);
  font-size: var(--text-sm);
  cursor: pointer;
}

button:hover {
  background: var(--surface-3);
}

/* --- Badges --- */
.badge {
  display: inline-block;
  padding: 2px var(--space-2);
  border-radius: var(--radius-sm);
  font-size: var(--text-xs);
  font-weight: 500;
  line-height: 1.4;
}

.badge-verified {
  background: rgba(74, 200, 154, 0.15);
  color: var(--accent-green);
}

.badge-inferred {
  background: rgba(229, 168, 75, 0.15);
  color: var(--accent-amber);
}

.badge-error {
  background: rgba(232, 84, 84, 0.15);
  color: var(--accent-red);
}

.badge-agent {
  background: rgba(167, 139, 250, 0.15);
  color: var(--accent-purple);
}

.badge-terminal {
  background: rgba(91, 196, 200, 0.15);
  color: var(--accent-cyan);
}

.session-status-active {
  background: rgba(74, 200, 154, 0.15);
  color: var(--accent-green);
}

.session-status-inactive {
  background: rgba(91, 156, 245, 0.15);
  color: var(--accent-blue);
}

.session-status-ended {
  background: rgba(160, 160, 170, 0.15);
  color: var(--text-secondary);
}

/* --- Tables --- */
table {
  width: 100%;
  border-collapse: collapse;
}

th, td {
  padding: var(--space-2) var(--space-3);
  text-align: left;
  border-bottom: 1px solid var(--border-subtle);
}

th {
  color: var(--text-secondary);
  font-weight: 600;
  font-size: var(--text-xs);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

tr:hover {
  background: var(--surface-1);
}

/* --- Form elements --- */
input, textarea {
  background: var(--surface-1);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-sm);
  color: var(--text-primary);
  font-family: var(--font-ui);
  font-size: var(--text-sm);
  padding: var(--space-2) var(--space-3);
}

input:focus, textarea:focus {
  outline: none;
  border-color: var(--accent-blue);
}

input::placeholder, textarea::placeholder {
  color: var(--text-tertiary);
}

/* --- Empty state --- */
.empty-state {
  text-align: center;
  padding: var(--space-7);
  color: var(--text-tertiary);
  font-size: var(--text-base);
}

/* --- Page header --- */
.page-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--space-6);
}

.page-header-actions {
  display: flex;
  gap: var(--space-2);
}

/* --- Filter bar --- */
.filter-bar {
  display: flex;
  gap: var(--space-2);
  flex-wrap: wrap;
  margin-bottom: var(--space-4);
}

.filter-btn {
  padding: var(--space-2) var(--space-3);
  border: 1px solid var(--border-subtle);
  border-radius: var(--radius-sm);
  background: var(--surface-2);
  color: var(--text-secondary);
  font-family: var(--font-ui);
  font-size: var(--text-xs);
  cursor: pointer;
  transition: background 0.15s, color 0.15s;
}

.filter-btn:hover {
  background: var(--surface-3);
  color: var(--text-primary);
}

.filter-btn.is-active {
  background: #1a3d2c;
  color: var(--accent-green);
  border-color: #2a6a4a;
}

/* --- Project sections --- */
.project-section {
  margin-bottom: var(--space-6);
}

.project-header {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  margin-bottom: var(--space-2);
}

.project-name {
  font-size: var(--text-lg);
  font-weight: 600;
}

.project-count {
  color: var(--text-tertiary);
  font-size: var(--text-sm);
  font-weight: normal;
}

/* --- Section heading --- */
.section-heading {
  font-size: var(--text-lg);
  margin-bottom: var(--space-2);
}

/* --- Subagent toggle --- */
.subagent-toggle {
  color: var(--accent-purple);
  font-size: var(--text-xs);
  cursor: pointer;
  margin-left: var(--space-1);
}

/* --- Disabled buttons --- */
.btn[disabled] {
  opacity: 0.5;
  cursor: not-allowed;
  pointer-events: none;
}

/* --- Ingest progress --- */
.ingest-progress {
  margin-bottom: var(--space-2);
  font-size: var(--text-sm);
}

/* --- Sync indicators --- */
.sync-syncing {
  color: var(--accent-amber);
  font-size: 0.85em;
  animation: pulse 1.5s infinite;
}

.sync-completed {
  color: var(--accent-green);
  font-size: 0.85em;
}

.sync-error {
  color: var(--accent-red);
  font-size: 0.85em;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

/* --- Utility classes --- */
.text-muted { color: var(--text-tertiary); }
.text-xs { font-size: var(--text-xs); }
.text-sm { font-size: var(--text-sm); }
.text-error { color: var(--accent-red); }
.text-warning { color: var(--accent-amber); }
.text-secondary { color: var(--text-secondary); }
.text-center { text-align: center; }
.mt-2 { margin-top: var(--space-2); }
.mt-3 { margin-top: var(--space-3); }
.mt-4 { margin-top: var(--space-4); }
.mb-2 { margin-bottom: var(--space-2); }
.mb-4 { margin-bottom: var(--space-4); }
.gap-1 { gap: var(--space-1); }
.gap-2 { gap: var(--space-2); }
.flex { display: flex; }
.items-center { align-items: center; }

/* --- Filter label & section --- */
.filter-label {
  display: block;
  color: var(--text-tertiary);
  font-size: var(--text-xs);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-bottom: var(--space-1);
}

.filter-section {
  display: flex;
  gap: var(--space-8);
  margin-bottom: var(--space-4);
  flex-wrap: wrap;
}

/* --- History commit cards --- */
.history-commit-card {
  background: var(--surface-1);
  border: 1px solid var(--border-subtle);
  border-radius: var(--radius-md);
  margin-bottom: var(--space-3);
  padding: var(--space-3);
}

.history-commit-header {
  display: flex;
  align-items: baseline;
  gap: var(--space-3);
  margin-bottom: var(--space-2);
}

.history-commit-hash {
  color: var(--accent-amber);
  font-family: var(--font-mono);
  font-size: var(--text-sm);
}

.history-commit-subject {
  flex: 1;
  color: var(--text-primary);
}

.history-commit-branch {
  color: var(--text-secondary);
  font-size: var(--text-xs);
}

.history-commit-time {
  color: var(--text-tertiary);
  font-size: var(--text-xs);
}

.history-commit-message {
  flex: 1;
  min-width: 0;
}

.history-commit-body {
  margin-top: var(--space-1);
  color: var(--text-secondary);
  font-size: var(--text-xs);
  white-space: pre-wrap;
}

.history-session-empty {
  margin-left: var(--space-6);
  padding: var(--space-2) 0;
  border-top: 1px solid var(--border-subtle);
  color: var(--text-tertiary);
  font-size: var(--text-xs);
}

.history-session-entry {
  margin-left: var(--space-6);
  padding: var(--space-2) 0;
  border-top: 1px solid var(--border-subtle);
  display: flex;
  align-items: center;
  gap: var(--space-2);
  flex-wrap: wrap;
}

.history-session-link {
  color: var(--accent-blue);
  font-size: var(--text-sm);
}

.history-session-project {
  color: var(--text-secondary);
  font-size: var(--text-xs);
}

/* --- Flash messages --- */
.flash-info {
  background: rgba(74, 200, 154, 0.1);
  color: var(--accent-green);
  padding: var(--space-2) var(--space-4);
  border-radius: var(--radius-sm);
  margin-bottom: var(--space-4);
  font-size: var(--text-sm);
}

.flash-error {
  background: rgba(232, 84, 84, 0.1);
  color: var(--accent-red);
  padding: var(--space-2) var(--space-4);
  border-radius: var(--radius-sm);
  margin-bottom: var(--space-4);
  font-size: var(--text-sm);
}

/* --- Review header --- */
.review-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--space-3);
}

.review-count {
  color: var(--text-secondary);
  font-size: var(--text-sm);
}

.review-actions {
  display: flex;
  gap: var(--space-2);
}

/* --- Hidden section --- */
.hidden-toggle {
  background: none;
  border: none;
  color: var(--text-tertiary);
  cursor: pointer;
  font-size: 0.85em;
  font-family: var(--font-ui);
  padding: var(--space-1) 0;
}

.hidden-toggle:hover {
  color: var(--text-secondary);
}

.hidden-table {
  opacity: 0.7;
}

/* --- Subagent row --- */
.subagent-row {
  opacity: 0.8;
  font-size: 0.9em;
}

.subagent-row td:first-child {
  padding-left: var(--space-6);
}

/* --- Load more --- */
.load-more {
  text-align: center;
  margin-top: var(--space-2);
}

/* ============================================================
   Session Layout (3-panel)
   ============================================================ */

.session-layout {
  display: flex;
  gap: 0;
  height: calc(100vh - 37px);
}

.session-terminal {
  flex: 2;
  overflow-x: auto;
  padding: var(--space-4);
}

.session-terminal-inner {
  display: inline-block;
  min-width: 100%;
}

.terminal-container {
  display: inline-block;
}

.terminal-connecting {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  color: var(--text-tertiary);
}

.terminal-connecting-title {
  font-size: var(--text-lg);
  margin-bottom: var(--space-2);
  text-align: center;
}

.terminal-connecting-subtitle {
  color: var(--text-tertiary);
  font-size: var(--text-sm);
  text-align: center;
}

.session-transcript {
  flex: 1;
  padding: var(--space-4);
  overflow-y: auto;
  border-left: 1px solid var(--border-default);
  background: var(--surface-1);
}

.session-sidebar {
  flex: 1;
  background: var(--surface-1);
  overflow-y: auto;
  border-left: 1px solid var(--border-default);
  display: flex;
  flex-direction: column;
}

/* --- Sidebar Tabs --- */
.sidebar-tabs {
  display: flex;
  border-bottom: 1px solid var(--border-default);
  flex-shrink: 0;
}

.sidebar-tab {
  padding: var(--space-2) var(--space-4);
  font-size: var(--text-xs);
  font-family: var(--font-ui);
  color: var(--text-tertiary);
  background: none;
  border: none;
  border-bottom: 2px solid transparent;
  cursor: pointer;
  transition: color 0.15s, border-color 0.15s;
}

.sidebar-tab:hover {
  color: var(--text-secondary);
  background: none;
}

.sidebar-tab.is-active {
  color: var(--accent-blue);
  border-bottom-color: var(--accent-blue);
}

.sidebar-tab-content {
  padding: var(--space-4);
  flex: 1;
  overflow-y: auto;
}

/* --- Commit cards --- */
.commit-card {
  background: var(--surface-2);
  border-radius: var(--radius-md);
  padding: var(--space-3);
  margin-bottom: var(--space-2);
}

.commit-hash {
  color: var(--accent-amber);
  font-family: var(--font-mono);
  font-size: var(--text-xs);
}

.commit-subject {
  color: var(--text-primary);
  font-size: var(--text-xs);
  margin-top: var(--space-1);
}

.commit-branch {
  color: var(--text-tertiary);
  font-size: var(--text-xs);
  margin-top: 2px;
}

/* --- Annotation cards --- */
.annotation-card {
  background: var(--surface-2);
  border-radius: var(--radius-md);
  padding: var(--space-3);
  margin-bottom: var(--space-2);
  cursor: pointer;
  transition: background 0.15s;
}

.annotation-card:hover {
  background: var(--surface-3);
}

.annotation-text {
  margin: 0 0 var(--space-2) 0;
  color: var(--text-secondary);
  white-space: pre-wrap;
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  max-height: 60px;
  overflow-y: auto;
}

.annotation-comment {
  margin: 0;
  color: var(--text-primary);
  font-size: var(--text-sm);
}

.annotation-meta {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: var(--space-2);
}

.annotation-time {
  font-size: var(--text-xs);
  color: var(--text-tertiary);
}

/* --- Annotation source badges --- */
.annotation-source-badge {
  display: inline-block;
  font-size: var(--text-xs);
  padding: 1px 6px;
  border-radius: 3px;
}

.annotation-source-transcript {
  background: rgba(91, 156, 245, 0.15);
  color: var(--accent-blue);
}

.annotation-source-terminal {
  background: rgba(229, 168, 75, 0.15);
  color: var(--accent-amber);
}

.annotation-source-file {
  background: rgba(74, 200, 154, 0.15);
  color: var(--accent-green);
}

/* --- Annotation form --- */
.annotation-form {
  background: var(--surface-2);
  border-radius: var(--radius-md);
  padding: var(--space-3);
  margin-bottom: var(--space-4);
}

.annotation-form-hint {
  font-size: var(--text-xs);
  color: var(--text-secondary);
  margin-bottom: var(--space-2);
}

.annotation-form-preview {
  margin: 0 0 var(--space-3) 0;
  color: var(--text-primary);
  white-space: pre-wrap;
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  max-height: 100px;
  overflow-y: auto;
}

.annotation-form-textarea {
  width: 100%;
  min-height: 60px;
  resize: vertical;
}

.annotation-form-actions {
  display: flex;
  gap: var(--space-2);
  margin-top: var(--space-2);
}

/* --- Transcript header --- */
.transcript-header {
  display: flex;
  align-items: center;
  margin-bottom: var(--space-3);
}

/* --- Code block in transcript --- */
.row-text-code {
  margin: 0;
  display: flex;
  align-items: flex-start;
  gap: 6px;
  width: 100%;
}

/* ============================================================
   Transcript Panel
   ============================================================ */

#transcript-panel {
  background: var(--surface-1);
  color: var(--text-primary);
}

#transcript-panel h3 {
  color: var(--text-primary);
}

#transcript-panel .transcript-header-hint {
  color: var(--text-secondary);
  font-size: 0.7em;
  margin-left: auto;
}

/* Transcript rows */
.transcript-row {
  padding: 2px 6px;
  border-left: 2px solid transparent;
  font-family: var(--font-mono);
  font-size: 0.8em;
  line-height: 1.5;
  word-break: break-word;
}

.transcript-row .row-main {
  display: flex;
  align-items: flex-start;
  gap: 6px;
}

.transcript-row.is-active {
  background: rgba(91, 156, 245, 0.12);
  border-left-color: var(--accent-blue);
}

/* Kind: text */
.transcript-row .row-text {
  color: var(--text-primary);
  flex: 1;
  min-width: 0;
}

.transcript-row .row-text a {
  color: var(--accent-blue);
  text-decoration: underline;
}

.transcript-row .row-text code {
  background: rgba(255, 255, 255, 0.08);
  border-radius: 3px;
  padding: 0 4px;
}

.transcript-row.is-user .row-text {
  color: var(--accent-blue);
}

/* Kind: thinking */
.transcript-row.is-thinking {
  background: var(--surface-2);
  border-radius: 3px;
  margin: 1px 0;
}

.transcript-row.is-thinking .row-text {
  color: var(--text-secondary);
  font-style: italic;
}

/* Kind: tool_use (thread opener) */
.transcript-row.is-tool-use {
  background: var(--surface-2);
  border-left-color: var(--text-tertiary);
  margin-top: 4px;
  font-weight: 500;
}

.transcript-row.is-tool-use .row-text {
  color: var(--text-secondary);
}

/* Kind: tool_use – Bash success */
.transcript-row.is-tool-use.is-bash-success {
  background: rgba(74, 200, 154, 0.14);
  border-left-color: var(--accent-green);
}

.transcript-row.is-tool-use.is-bash-success .row-text {
  color: var(--accent-green);
}

/* Kind: tool_use – Bash error */
.transcript-row.is-tool-use.is-bash-error {
  background: rgba(232, 84, 84, 0.14);
  border-left-color: var(--accent-red);
}

.transcript-row.is-tool-use.is-bash-error .row-text {
  color: var(--accent-red);
}

/* Kind: ask_user_question */
.transcript-row.is-ask-user-question {
  background: rgba(91, 156, 245, 0.10);
  border-left-color: var(--accent-blue);
}

.transcript-row.is-ask-user-question .row-text {
  color: var(--accent-blue);
}

/* Kind: ask_user_answer */
.transcript-row.is-ask-user-answer {
  background: rgba(91, 156, 245, 0.06);
  border-left-color: var(--accent-blue);
  padding-left: 14px;
}

.transcript-row.is-ask-user-answer .row-text {
  color: var(--text-primary);
}

/* Kind: plan_content */
.transcript-row.is-plan-content {
  background: rgba(167, 139, 250, 0.06);
  border-left-color: var(--accent-purple);
  padding-left: 14px;
}

.transcript-row.is-plan-content .row-text {
  color: var(--text-secondary);
}

/* Kind: plan_decision */
.transcript-row.is-plan-decision {
  background: rgba(167, 139, 250, 0.12);
  border-left-color: var(--accent-purple);
  font-weight: 500;
}

.transcript-row.is-plan-decision .row-text {
  color: var(--accent-purple);
}

/* Kind: tool_result (threaded under tool_use) */
.transcript-row.is-tool-result {
  background: var(--surface-2);
  border-left-color: var(--border-default);
  padding-left: 14px;
}

.transcript-row.is-tool-result .row-text {
  color: var(--text-secondary);
}

/* Kind: code – consecutive code rows form a continuous block */
.transcript-row.is-code {
  padding-top: 0;
  padding-bottom: 0;
}

.transcript-row.is-code .row-text {
  font-family: var(--font-mono);
  background: var(--surface-3);
  border-radius: 2px;
  padding: 0 4px;
}

.transcript-row pre.row-text {
  margin: 0;
}

/* Kind: thinking – bulb icon */
.thinking-icon {
  flex-shrink: 0;
}

/* Kind: hook_progress */
.transcript-row.is-hook-progress {
  opacity: 0.85;
}

.transcript-row.is-hook-progress .row-text {
  color: var(--text-tertiary);
}

.source-line-number {
  color: var(--text-tertiary);
  flex-shrink: 0;
  min-width: 4ch;
  text-align: right;
  user-select: none;
}

.row-token-count {
  color: var(--text-tertiary);
  flex-shrink: 0;
  font-size: 0.9em;
  margin-left: auto;
  white-space: nowrap;
}

/* Subagent rows */
.transcript-row.is-subagent {
  border-left-color: var(--accent-purple);
  background: rgba(167, 139, 250, 0.06);
}

.transcript-row.is-subagent .subagent-badge {
  display: inline-block;
  background: var(--accent-purple);
  color: var(--surface-0);
  font-size: 0.75em;
  padding: 0 4px;
  border-radius: 3px;
  margin-right: 4px;
  cursor: pointer;
  vertical-align: middle;
}

.transcript-row.is-subagent .subagent-badge:hover {
  background: #9678ea;
}

.transcript-row.is-subagent.is-clicked {
  border-left-color: #8b6de0;
  background: rgba(167, 139, 250, 0.12);
}

/* Error panel in transcript */
.transcript-error-panel {
  margin-bottom: 1rem;
  background: rgba(232, 84, 84, 0.08);
  border: 1px solid rgba(232, 84, 84, 0.25);
  border-radius: var(--radius-md);
  padding: 0.75rem;
}

.transcript-error-panel .error-title {
  color: var(--accent-red);
  font-size: 0.85em;
  font-weight: bold;
  margin-bottom: 0.5rem;
}

.transcript-error-item {
  padding: 4px 6px;
  margin-bottom: 4px;
  cursor: pointer;
  border-radius: var(--radius-sm);
  font-size: 0.8em;
}

.transcript-error-item:hover {
  background: rgba(232, 84, 84, 0.1);
}

.transcript-error-item .error-tool {
  color: var(--accent-red);
  font-weight: bold;
}

.transcript-error-item .error-content {
  color: var(--text-secondary);
  margin-left: 0.5rem;
}

/* Rework panel in transcript */
.transcript-rework-panel {
  margin-bottom: 1rem;
  background: rgba(229, 168, 75, 0.08);
  border: 1px solid rgba(229, 168, 75, 0.25);
  border-radius: var(--radius-md);
  padding: 0.75rem;
}

.transcript-rework-panel .rework-title {
  color: var(--accent-amber);
  font-size: 0.85em;
  font-weight: bold;
  margin-bottom: 0.5rem;
}

.transcript-rework-item {
  padding: 4px 6px;
  margin-bottom: 4px;
  cursor: pointer;
  border-radius: var(--radius-sm);
  font-size: 0.8em;
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.transcript-rework-item:hover {
  background: rgba(229, 168, 75, 0.1);
}

.transcript-rework-item .rework-file {
  color: var(--text-primary);
  word-break: break-all;
}

.transcript-rework-item .rework-occurrence {
  color: var(--accent-amber);
  font-weight: 600;
  white-space: nowrap;
}

/* Jump highlight */
.transcript-row.is-jump-highlight {
  background: rgba(229, 168, 75, 0.18);
  border-left-color: var(--accent-amber);
  transition: background 0.3s ease;
}

/* Empty state */
.transcript-empty {
  color: var(--text-tertiary);
  font-style: italic;
  font-size: 0.85em;
}

/* Debug grid layout */
.transcript-debug-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 0;
}

.transcript-debug-grid .transcript-row {
  border-right: 1px solid var(--border);
}

.transcript-debug-sidecar {
  padding: 2px 6px;
  overflow-x: auto;
  background: var(--surface-2);
  border-bottom: 1px solid var(--border);
}

.transcript-debug-sidecar pre {
  margin: 0;
  font-size: var(--text-xs);
  line-height: 1.4;
  white-space: pre-wrap;
  word-break: break-word;
}

.transcript-debug-sidecar code {
  font-family: var(--font-mono);
}

/* Expand controls */
.transcript-expand-control {
  padding: 2px 6px;
}

.transcript-debug-grid .transcript-expand-control {
  grid-column: 1 / -1;
}

.btn-expand-tool-result {
  background: none;
  border: none;
  color: var(--accent-blue);
  font-size: var(--text-xs);
  cursor: pointer;
  padding: 2px 4px;
}

.btn-expand-tool-result:hover {
  text-decoration: underline;
}

/* Thread grouping */
.transcript-thread {
  margin-bottom: 2px;
}

/* highlight.js code blocks */
.transcript-row pre.row-text {
  white-space: pre-wrap;
  word-break: break-word;
  line-height: 1.5;
}

.transcript-row pre.row-text code {
  font-family: var(--font-mono);
  font-size: inherit;
  flex: 1;
  padding: 0;
  background: transparent;
}

/* ============================================================
   Commit Detail Layout
   ============================================================ */

.commit-detail-layout {
  display: flex;
  gap: 0;
  height: calc(100vh - 37px);
}

.commit-detail-diff {
  flex: 2;
  overflow-y: auto;
  padding: var(--space-4);
}

.commit-detail-transcript {
  flex: 1;
  overflow-y: auto;
  padding: var(--space-4);
  border-left: 1px solid var(--border-default);
  background: var(--surface-1);
}

.commit-detail-header {
  margin-bottom: var(--space-4);
}

.commit-detail-meta {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  margin-bottom: var(--space-2);
}

.commit-detail-subject {
  font-size: var(--text-lg);
  font-weight: 600;
  margin-bottom: var(--space-1);
}

.commit-detail-body {
  color: var(--text-secondary);
  font-size: var(--text-sm);
  white-space: pre-wrap;
  margin-bottom: var(--space-2);
}

.commit-detail-info {
  display: flex;
  align-items: center;
  gap: var(--space-3);
}

.commit-detail-section-title {
  color: var(--text-secondary);
  font-size: var(--text-xs);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-bottom: var(--space-2);
}

.commit-detail-files {
  margin-bottom: var(--space-4);
  background: var(--surface-1);
  border-radius: var(--radius-md);
  padding: var(--space-3);
}

.commit-detail-file {
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  color: var(--text-primary);
  padding: 2px 0;
}

.commit-detail-diff-content {
  margin-bottom: var(--space-4);
}

.commit-detail-diff-content pre {
  background: var(--surface-1);
  border-radius: var(--radius-md);
  padding: var(--space-3);
  overflow-x: auto;
  font-size: var(--text-xs);
  line-height: 1.5;
}

.commit-detail-diff-content code {
  font-family: var(--font-mono);
}

.commit-detail-cochange {
  background: var(--surface-1);
  border-radius: var(--radius-md);
  padding: var(--space-3);
  margin-bottom: var(--space-4);
}

.commit-detail-cochange-group {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-2);
  align-items: center;
  padding: var(--space-1) 0;
  border-bottom: 1px solid var(--border-subtle);
}

.commit-detail-cochange-group:last-child {
  border-bottom: none;
}

.commit-detail-cochange-member {
  font-family: var(--font-mono);
  font-size: var(--text-xs);
  color: var(--accent-blue);
}

.commit-detail-session-list {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.commit-detail-session-btn {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  padding: var(--space-2) var(--space-3);
  border: 1px solid var(--border-subtle);
  border-radius: var(--radius-sm);
  background: var(--surface-2);
  color: var(--text-primary);
  font-family: var(--font-ui);
  font-size: var(--text-sm);
  cursor: pointer;
  text-align: left;
  transition: background 0.15s, border-color 0.15s;
}

.commit-detail-session-btn:hover {
  background: var(--surface-3);
  border-color: var(--border-default);
}

.commit-detail-session-btn.is-active {
  background: var(--surface-3);
  border-color: var(--accent-blue);
}

.commit-detail-session-name {
  flex: 1;
}

/* Mobile: stack panes vertically */
@media (max-width: 768px) {
  .commit-detail-layout {
    flex-direction: column;
    height: auto;
  }

  .commit-detail-transcript {
    border-left: none;
    border-top: 1px solid var(--border-default);
  }
}

/* ============================================================
   File Detail
   ============================================================ */

.file-detail-layout {
  display: flex;
  gap: 1rem;
  height: calc(100vh - 120px);
}

.file-detail-code {
  flex: 2;
  overflow-y: auto;
  padding-right: 1rem;
}

.file-detail-transcript {
  flex: 1;
  overflow-y: auto;
  border-left: 1px solid var(--border-default);
  padding-left: 1rem;
}

.file-detail-header {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  margin-bottom: 1rem;
}

.file-detail-path {
  font-family: var(--font-mono);
  font-size: 1rem;
  font-weight: 600;
  word-break: break-all;
}

.file-detail-content {
  margin-bottom: 1.5rem;
}

.file-detail-content pre {
  margin: 0;
  padding: 1rem;
  background: var(--bg-inset);
  border-radius: var(--radius-md);
  overflow-x: auto;
  font-size: 0.85rem;
  line-height: 1.5;
}

.file-detail-section-title {
  font-size: 0.85rem;
  font-weight: 600;
  color: var(--text-secondary);
  margin-bottom: 0.5rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.file-detail-commits {
  margin-bottom: 1.5rem;
}

.file-detail-commit-row {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.35rem 0;
  font-size: 0.85rem;
  border-bottom: 1px solid var(--border-subtle);
}

.file-detail-commit-subject {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.file-detail-annotations {
  margin-top: 1.5rem;
}

.file-detail-session-list {
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
}

.file-detail-session-btn {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.4rem 0.75rem;
  background: var(--bg-inset);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-md);
  cursor: pointer;
  font-size: 0.85rem;
  color: var(--text-primary);
  text-align: left;
  width: 100%;
}

.file-detail-session-btn:hover {
  border-color: var(--border-active);
}

.file-detail-session-btn.is-active {
  border-color: var(--accent-blue);
  background: var(--bg-overlay);
}

.file-detail-session-name {
  font-family: var(--font-mono);
}

.file-link {
  color: var(--accent-blue);
  text-decoration: none;
  font-family: var(--font-mono);
}

.file-link:hover {
  text-decoration: underline;
}

.badge-added { background: #16a34a; color: #fff; }
.badge-deleted { background: #dc2626; color: #fff; }
.badge-modified { background: #2563eb; color: #fff; }
.badge-renamed { background: #ca8a04; color: #fff; }

@media (max-width: 768px) {
  .file-detail-layout {
    flex-direction: column;
    height: auto;
  }

  .file-detail-transcript {
    border-left: none;
    border-top: 1px solid var(--border-default);
    padding-left: 0;
    padding-top: 1rem;
  }
}

/* ============================================================
   Syntax Highlighting — Dark (Graphite)
   Replaces GitHub-light hljs theme
   ============================================================ */

.hljs {
  background: transparent;
  color: var(--text-primary);
}

.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-section,
.hljs-link {
  color: var(--accent-red);
}

.hljs-function .hljs-keyword {
  color: var(--accent-red);
}

.hljs-string,
.hljs-title,
.hljs-name,
.hljs-type,
.hljs-attribute,
.hljs-symbol,
.hljs-bullet,
.hljs-addition,
.hljs-variable,
.hljs-template-tag,
.hljs-template-variable {
  color: var(--accent-green);
}

.hljs-comment,
.hljs-quote,
.hljs-deletion,
.hljs-meta {
  color: var(--text-tertiary);
}

.hljs-number,
.hljs-regexp,
.hljs-built_in,
.hljs-params {
  color: var(--accent-blue);
}

.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: bold;
}

/* --- Study Queue --- */
.study-queue {
  border: 1px solid var(--border-default);
  border-radius: var(--radius);
  padding: var(--space-4);
  background: var(--surface-1);
}

.importance-summary {
  display: flex;
  gap: var(--space-3);
}

.study-card {
  border: 1px solid var(--border-subtle);
  border-radius: var(--radius);
  padding: var(--space-3);
  margin-bottom: var(--space-2);
  background: var(--surface-2);
}

.study-card-header {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  margin-bottom: var(--space-2);
}

.study-card-body {
  margin-bottom: var(--space-2);
}

.study-commit-subject {
  font-weight: 500;
}

.study-commit-body {
  white-space: pre-wrap;
  max-height: 4em;
  overflow: hidden;
}

.study-hotspot-reason {
  font-weight: 500;
}

.study-hotspot-score {
  color: var(--text-secondary);
  font-size: 0.85em;
}

.study-card-actions {
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.importance-select {
  background: var(--surface-3);
  color: var(--text-primary);
  border: 1px solid var(--border-default);
  border-radius: var(--radius);
  padding: 0.25rem 0.5rem;
  font-size: 0.85em;
}

.badge.study-kind-commit_message {
  background: var(--accent-blue);
  color: var(--surface-0);
}

.badge.study-kind-commit_hotspot {
  background: var(--accent-amber);
  color: var(--surface-0);
}

.badge.study-importance-high {
  background: var(--accent-red);
  color: var(--surface-0);
}

.badge.study-importance-medium {
  background: var(--accent-amber);
  color: var(--surface-0);
}

.badge.study-importance-low {
  background: var(--surface-3);
  color: var(--text-secondary);
}

/* Prompt patterns */
.prompt-patterns-section .filter-bar.mt-1 {
  margin-top: 0.25rem;
}

.pp-project-counts {
  display: flex;
  flex-wrap: wrap;
  gap: 0.25rem;
  margin-top: 0.25rem;
}

.pp-project-counts .badge {
  font-size: 0.65rem;
  padding: 0.1rem 0.3rem;
}
